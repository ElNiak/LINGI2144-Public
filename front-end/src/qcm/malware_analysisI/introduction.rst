MCQ 8: Malware Analysis
***********************

Question 1. Part I
-------------------

.. question:: bo5
   :nb_prop: 4
   :nb_pos: 1

   |  What is a malware ?

   .. negative::

      - Malware is a piece of code which blocks screens with false accusation in harversting illegal content trying to scare the victime into paying up a fee.

   .. negative::

      - Malware is a piece of code which once installed, allow to take the control of the victim.

   .. negative::

      - Malware is a piece of code which spread and replicates itself.

   .. positive::

      - Malware is a piece of code which changes the behavior of either the operating system kernel or some security sensitive applications, without a user consent and in such a way that it is then impossible to detect those changes using a documented features of the operating system or the application


.. question:: bo1
   :nb_prop: 4
   :nb_pos: 1

   |  Which malicious program cannot do anything until actions are taken to activate the file attached by the malware ?

   .. negative::

      - Trojan Horse

   .. negative::

      - Loader

   .. negative::

      - Botnet

   .. positive::

      - Virus


.. question:: bo2
   :nb_prop: 4
   :nb_pos: 1

   |  What is an anti-virus ?

   .. negative::

      - Computer software used to prevent, detect and remove a maximal amount of virus.

   .. negative::

      - A bigger and more dangerous virus

   .. negative::

      - Computer software used to replicate a maximal amount of malware.

   .. positive::

      - Computer software used to prevent, detect and remove a maximal amount of malware.

.. question:: bo3
   :nb_prop: 4
   :nb_pos: 1

   |  What is a Spyware ?

   .. negative::

      - A type of malware installed on computers that collects information about users without their knowledge

   .. negative::

      - The presence of spyware is typically hidden from the user and can be difficult to detect

   .. negative::

      - Spyware programs lurk on your computer to steal important information, like your passwords and logins and other personal identification information and then send it off to someone else

   .. positive::

      - All of the above


.. question:: bo3
   :nb_prop: 4
   :nb_pos: 1

   |  What is a honeypot ?

   .. negative::

      - A honeypot is a system that is intentionally left vulnerable to catch attacks and virus and study their behavior

   .. negative::

      - Product of beekeeper that Winnie the Pooh love to eat.

   .. positive::

      - A honeypot is a system that is intentionally left vulnerable to catch attacks and malware and study their behavior


.. question:: bo7
   :nb_prop: 3
   :nb_pos: 1

   |  What kind of honeypot would you recommended to catch a Mirai ?

   .. negative::

      - Strong interaction honeypot is enough

   .. negative::

      - Weak interaction honeypot is enough

   .. positive::

      - Middle interaction honeypot is enough


Question 2. Part II
-------------------

.. question:: bo7
   :nb_prop: 3
   :nb_pos: 1

   | Yara is:

   .. negative::

      - A virus scanner

   .. negative::

      - A correlation engine

   .. negative::

      - A bayesian classifier

   .. negative::

      - An AI

   .. positive::

      - An elegant way to specify any type of regular expression

   .. positive::

      - Fast and efficient at detection

   .. positive::

      - Look for syntactic properties of file

   .. positive::

      - Does not execute the sample during analysis (i.e. static)

   .. positive::

      - Plugins to python and other languages

   .. positive::

      - Protections against REGEX attacks


.. question:: shell
   :nb_prop: 4
   :nb_pos: 1

   | Consider the following code:

   .. code-block:: c

        int malicious_behavior() {
            char * rev1 = "am I";
            char * rev2 = "\n!!!live ";

            printf(strrev(rev1));
            printf(strrev(rev2));
        }
        int main(int argc , char argv) {
            malicious_behavior();
        }


   | What Yara rule will detect that the program print "``I am evil!!!\n`" ?

   .. positive::

      .. code-block:: c

        rule Malware_Prints_Evil {
           meta:
              description = "Malware Simple Rule To Detect Printing <I am evil!!!>"
              author = "bla bla"
              date = "2020-05-04"
           strings:
              $rr1_rev ="ma I" nocase
              $rr2_rev ="!!!live" nocase
              $ra1 = "reverse" nocase
              $ra2 = "strrev" nocase

              $x3 = "printf" nocase
              $x4 = "printf@@GLIBC_2.0" nocase
           condition:
              ($rr1_rev and ($ra1 or $ra2) and (1 of ($x*)) and ($rr2_rev and ($ra1 or $ra2) and (1 of ($x*))
        }


   .. negative::

      - None of them it's impossible to detect that with static analysis

   .. negative::

      .. code-block:: c

        rule Malware_Simple_v0_1 {
           meta:
              description = "Malware Simple Rule To Detect Printing <I am evil!!!>"
              author = "bla bla"
              date = "2020-05-04"
           strings:
              $s1 = "I am"
              $s2 = " evil!!!"
           condition:
              $s1 and $s2
        }


   .. negative::

      .. code-block:: c

        rule Malware_Prints_Evil {
           meta:
              description = "Malware Simple Rule To Detect Printing <I am evil!!!>"
              author = "bla bla"
              date = "2020-05-04"
           strings:
              $rr1_rev ="I am" nocase
              $rr2_rev =" evil!!!" nocase
              $ra1 = "reverse" nocase
              $ra2 = "strrev" nocase

              $x3 = "printf" nocase
              $x4 = "printf@@GLIBC_2.0" nocase
           condition:
              ($rr1_rev and ($ra1 or $ra2) and (1 of ($x*)) and ($rr2_rev and ($ra1 or $ra2) and (1 of ($x*))
        }


..
    TODO: check if good

.. question:: shell
   :nb_prop: 4
   :nb_pos: 1

   | Consider the following code:

   .. code-block:: c

        int malicious_behavior() {
            char * byt1 = "\x49\x20\x61\x6d\x0a";
            char * byt2 = "\x20\x65\x76\x69\x6c\x21\x21\x21";

            printf("%c",byt1);
            printf("%c",byt2);
        }
        int main(int argc , char argv) {
            malicious_behavior();
        }



   | What Yara rule will detect that the program print "``I am evil!!!\n``" ?

   .. positive::

      .. code-block:: c

        rule Malware_Simple_v0_1 {
           meta:
              description = "Malware Simple Rule To Detect Printing <I am evil!!!>"
              author = "bla bla"
              date = "2020-05-04"
           strings:
              $s1 = { 49 20 61 6d 0a }
              $s2 = { 20 65 76 69 6c 21 21 21 }
              $s3 = "%c"
           condition:
              $s1 and $s2 and $s3
        }

   .. negative::

      - None of them it's impossible to detect that with static analysis

   .. negative::

      .. code-block:: c

        rule Malware_Simple_v0_1 {
           meta:
              description = "Malware Simple Rule To Detect Printing <I am evil!!!>"
              author = "bla bla"
              date = "2020-05-04"
           strings:
              $s1 = "I am"
              $s2 = " evil!!!"
           condition:
              $s1 and $s2
        }


   .. negative::

      .. code-block:: c

        rule Malware_Simple_v0_1 {
           meta:
              description = "Malware Simple Rule To Detect Printing <I am evil!!!>"
              author = "bla bla"
              date = "2020-05-04"
           strings:
              $s1 = { 49 20 61 6d 0a }
              $s2 = { 20 65 76 69 6c 21 21 21 }
           condition:
              $s1 and $s2
        }


Question 3. Part III
--------------------

